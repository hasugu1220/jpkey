<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏùºÎ≥∏Ïñ¥ Í∞ÄÏÉÅ ÌÇ§Î≥¥Îìú (Ïπ¥ÌÜ° Í≥µÏú†)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
            width: 100%;
            max-width: 800px;
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 20px;
            font-size: 2em;
        }

        .input-section {
            margin-bottom: 30px;
        }

        .text-area {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 18px;
            font-family: 'Noto Sans JP', 'Hiragino Kaku Gothic Pro', sans-serif;
            resize: vertical;
            outline: none;
            transition: border-color 0.3s;
        }

        .text-area:focus {
            border-color: #667eea;
        }

        .controls {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 1px solid #ddd;
        }

        .btn-secondary:hover {
            background: #e9ecef;
            transform: translateY(-2px);
        }

        .keyboard-modes {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .mode-btn {
            padding: 12px 24px;
            border: 2px solid #667eea;
            border-radius: 25px;
            background: white;
            color: #667eea;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .mode-btn.active {
            background: #667eea;
            color: white;
        }

        .mode-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .keyboard {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            position: relative;
        }

        .keyboard-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 15px;
            margin-bottom: 15px;
        }

        .key {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 20px 15px;
            text-align: center;
            cursor: pointer;
            font-size: 24px;
            font-family: 'Noto Sans JP', sans-serif;
            transition: all 0.2s;
            min-height: 70px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            user-select: none;
        }

        .key:hover {
            background: #e3f2fd;
            border-color: #2196f3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .key:active {
            transform: translateY(0);
            background: #bbdefb;
        }

        .key.has-variants::after {
            content: "‚ñº";
            position: absolute;
            bottom: 5px;
            right: 8px;
            font-size: 12px;
            color: #666;
        }

        .special-keys {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .special-key {
            background: #667eea;
            color: white;
            font-weight: 600;
            min-width: 80px;
        }

        .special-key:hover {
            background: #5a6fd8;
        }

        .wide-key {
            min-width: 150px;
        }

        .hidden {
            display: none;
        }

        /* ÌåùÏóÖ Ïä§ÌÉÄÏùº */
        .popup-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.3);
            display: none;
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .popup-overlay.active {
            display: flex;
        }

        .popup {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
            min-width: 300px;
        }

        .popup-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
        }

        .popup-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
        }

        .popup-key {
            background: #f8f9fa;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            padding: 15px 10px;
            text-align: center;
            cursor: pointer;
            font-size: 20px;
            font-family: 'Noto Sans JP', sans-serif;
            transition: all 0.2s;
            min-height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .popup-key:hover {
            background: #e3f2fd;
            border-color: #2196f3;
            transform: scale(1.05);
        }

        .popup-key.dakuten {
            background: #ffecb3;
            border-color: #ff9800;
        }

        .popup-key.handakuten {
            background: #e1f5fe;
            border-color: #03a9f4;
        }

        .popup-key.small {
            background: #f3e5f5;
            border-color: #9c27b0;
        }

        .close-popup {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .close-popup:hover {
            color: #333;
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px;
                margin: 10px;
            }
            
            .keyboard-grid {
                grid-template-columns: repeat(5, 1fr);
                gap: 10px;
            }
            
            .key {
                padding: 15px 10px;
                font-size: 20px;
                min-height: 60px;
            }
            
            .popup {
                margin: 20px;
                min-width: 280px;
            }
            
            .popup-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üáØüáµ ÏùºÎ≥∏Ïñ¥ Í∞ÄÏÉÅ ÌÇ§Î≥¥Îìú</h1>
        
        <div class="input-section">
            <textarea id="textInput" class="text-area" placeholder="ÌÇ§Î•º ÎàÑÎ•¥Î©¥ Í¥ÄÎ†® Î¨∏ÏûêÎì§Ïù¥ ÌåùÏóÖÏúºÎ°ú ÎÇòÌÉÄÎÇ©ÎãàÎã§..."></textarea>
            <div class="controls">
                <button class="btn btn-primary" onclick="copyText()">üìã Î≥µÏÇ¨</button>
                <button class="btn btn-secondary" onclick="clearText()">üóëÔ∏è ÏßÄÏö∞Í∏∞</button>
            </div>
        </div>

        <div class="keyboard-modes">
            <button class="mode-btn active" onclick="switchMode('hiragana')">„Å≤„Çâ„Åå„Å™</button>
            <button class="mode-btn" onclick="switchMode('katakana')">„Ç´„Çø„Ç´„Éä</button>
        </div>

        <!-- ÌûàÎùºÍ∞ÄÎÇò ÌÇ§Î≥¥Îìú -->
        <div id="hiragana-keyboard" class="keyboard">
            <div class="keyboard-grid">
                <div class="key has-variants" onclick="showPopup('a')">„ÅÇ</div>
                <div class="key has-variants" onclick="showPopup('ka')">„Åã</div>
                <div class="key has-variants" onclick="showPopup('sa')">„Åï</div>
                <div class="key has-variants" onclick="showPopup('ta')">„Åü</div>
                <div class="key has-variants" onclick="showPopup('na')">„Å™</div>
                
                <div class="key has-variants" onclick="showPopup('ha')">„ÅØ</div>
                <div class="key has-variants" onclick="showPopup('ma')">„Åæ</div>
                <div class="key has-variants" onclick="showPopup('ya')">„ÇÑ</div>
                <div class="key has-variants" onclick="showPopup('ra')">„Çâ</div>
                <div class="key has-variants" onclick="showPopup('wa')">„Çè</div>
            </div>
            
            <div class="special-keys">
                <div class="key special-key" onclick="insertText('„ÄÅ')">„ÄÅ</div>
                <div class="key special-key" onclick="insertText('„ÄÇ')">„ÄÇ</div>
                <div class="key special-key" onclick="insertText('„Éº')">„Éº</div>
                <div class="key special-key has-variants" onclick="showPopup('small')">Â∞èÊñáÂ≠ó</div>
                <div class="key special-key wide-key" onclick="insertText(' ')">„Çπ„Éö„Éº„Çπ</div>
                <div class="key special-key" onclick="backspace()">‚å´</div>
            </div>
        </div>

        <!-- Ïπ¥ÌÉÄÏπ¥ÎÇò ÌÇ§Î≥¥Îìú -->
        <div id="katakana-keyboard" class="keyboard hidden">
            <div class="keyboard-grid">
                <div class="key has-variants" onclick="showPopup('A')">„Ç¢</div>
                <div class="key has-variants" onclick="showPopup('KA')">„Ç´</div>
                <div class="key has-variants" onclick="showPopup('SA')">„Çµ</div>
                <div class="key has-variants" onclick="showPopup('TA')">„Çø</div>
                <div class="key has-variants" onclick="showPopup('NA')">„Éä</div>
                
                <div class="key has-variants" onclick="showPopup('HA')">„Éè</div>
                <div class="key has-variants" onclick="showPopup('MA')">„Éû</div>
                <div class="key has-variants" onclick="showPopup('YA')">„É§</div>
                <div class="key has-variants" onclick="showPopup('RA')">„É©</div>
                <div class="key has-variants" onclick="showPopup('WA')">„ÉØ</div>
            </div>
            
            <div class="special-keys">
                <div class="key special-key" onclick="insertText('„ÄÅ')">„ÄÅ</div>
                <div class="key special-key" onclick="insertText('„ÄÇ')">„ÄÇ</div>
                <div class="key special-key" onclick="insertText('„Éº')">„Éº</div>
                <div class="key special-key has-variants" onclick="showPopup('smallKata')">Â∞èÎ¨∏Ïûê</div>
                <div class="key special-key wide-key" onclick="insertText(' ')">„Çπ„Éö„Éº„Çπ</div>
                <div class="key special-key" onclick="backspace()">‚å´</div>
            </div>
        </div>
    </div>

    <!-- ÌåùÏóÖ Ïò§Î≤ÑÎ†àÏù¥ -->
    <div class="popup-overlay" id="popupOverlay" onclick="closePopup()">
        <div class="popup" onclick="event.stopPropagation()">
            <button class="close-popup" onclick="closePopup()">√ó</button>
            <div class="popup-title" id="popupTitle"></div>
            <div class="popup-grid" id="popupGrid"></div>
        </div>
    </div>

    <script>
        let currentMode = 'hiragana';
        
        const characterGroups = {
            'a': { title: '„ÅÇÌñâ', chars: ['„ÅÇ', '„ÅÑ', '„ÅÜ', '„Åà', '„Åä'] },
            'ka': { title: '„ÅãÌñâ / „ÅåÌñâ', chars: ['„Åã', '„Åç', '„Åè', '„Åë', '„Åì', '„Åå', '„Åé', '„Åê', '„Åí', '„Åî'] },
            'sa': { title: '„ÅïÌñâ / „ÅñÌñâ', chars: ['„Åï', '„Åó', '„Åô', '„Åõ', '„Åù', '„Åñ', '„Åò', '„Åö', '„Åú', '„Åû'] },
            'ta': { title: '„ÅüÌñâ / „Å†Ìñâ', chars: ['„Åü', '„Å°', '„Å§', '„Å¶', '„Å®', '„Å†', '„Å¢', '„Å•', '„Åß', '„Å©'] },
            'na': { title: '„Å™Ìñâ', chars: ['„Å™', '„Å´', '„Å¨', '„Å≠', '„ÅÆ'] },
            'ha': { title: '„ÅØÌñâ / „Å∞Ìñâ / „Å±Ìñâ', chars: ['„ÅØ', '„Å≤', '„Åµ', '„Å∏', '„Åª', '„Å∞', '„Å≥', '„Å∂', '„Åπ', '„Åº', '„Å±', '„Å¥', '„Å∑', '„Å∫', '„ÅΩ'] },
            'ma': { title: '„ÅæÌñâ', chars: ['„Åæ', '„Åø', '„ÇÄ', '„ÇÅ', '„ÇÇ'] },
            'ya': { title: '„ÇÑÌñâ', chars: ['„ÇÑ', '„ÇÜ', '„Çà'] },
            'ra': { title: '„ÇâÌñâ', chars: ['„Çâ', '„Çä', '„Çã', '„Çå', '„Çç'] },
            'wa': { title: '„ÇèÌñâ + „Çì', chars: ['„Çè', '„Çí', '„Çì'] },
            'small': { title: 'ÏûëÏùÄ Î¨∏Ïûê', chars: ['„ÅÅ', '„ÅÉ', '„ÅÖ', '„Åá', '„Åâ', '„Å£', '„ÇÉ', '„ÇÖ', '„Çá'] },
            'A': { title: '„Ç¢Ìñâ', chars: ['„Ç¢', '„Ç§', '„Ç¶', '„Ç®', '„Ç™'] },
            'KA': { title: '„Ç´Ìñâ / „Ç¨Ìñâ', chars: ['„Ç´', '„Ç≠', '„ÇØ', '„Ç±', '„Ç≥', '„Ç¨', '„ÇÆ', '„Ç∞', '„Ç≤', '„Ç¥'] },
            'SA': { title: '„ÇµÌñâ / „Ç∂Ìñâ', chars: ['„Çµ', '„Ç∑', '„Çπ', '„Çª', '„ÇΩ', '„Ç∂', '„Ç∏', '„Ç∫', '„Çº', '„Çæ'] },
            'TA': { title: '„ÇøÌñâ / „ÉÄÌñâ', chars: ['„Çø', '„ÉÅ', '„ÉÑ', '„ÉÜ', '„Éà', '„ÉÄ', '„ÉÇ', '„ÉÖ', '„Éá', '„Éâ'] },
            'NA': { title: '„ÉäÌñâ', chars: ['„Éä', '„Éã', '„Éå', '„Éç', '„Éé'] },
            'HA': { title: '„ÉèÌñâ / „ÉêÌñâ / „ÉëÌñâ', chars: ['„Éè', '„Éí', '„Éï', '„Éò', '„Éõ', '„Éê', '„Éì', '„Éñ', '„Éô', '„Éú', '„Éë', '„Éî', '„Éó', '„Éö', '„Éù'] },
            'MA': { title: '„ÉûÌñâ', chars: ['„Éû', '„Éü', '„É†', '„É°', '„É¢'] },
            'YA': { title: '„É§Ìñâ', chars: ['„É§', '„É¶', '„É®'] },
            'RA': { title: '„É©Ìñâ', chars: ['„É©', '„É™', '„É´', '„É¨', '„É≠'] },
            'WA': { title: '„ÉØÌñâ + „É≥', chars: ['„ÉØ', '„É≤', '„É≥'] },
            'smallKata': { title: 'ÏûëÏùÄ Î¨∏Ïûê', chars: ['„Ç°', '„Ç£', '„Ç•', '„Çß', '„Ç©', '„ÉÉ', '„É£', '„É•', '„Éß'] }
        };

        function getCharClass(char) {
            const dakuten = ['„Åå', '„Åé', '„Åê', '„Åí', '„Åî', '„Åñ', '„Åò', '„Åö', '„Åú', '„Åû', '„Å†', '„Å¢', '„Å•', '„Åß', '„Å©', '„Å∞', '„Å≥', '„Å∂', '„Åπ', '„Åº', '„Ç¨', '„ÇÆ', '„Ç∞', '„Ç≤', '„Ç¥', '„Ç∂', '„Ç∏', '„Ç∫', '„Çº', '„Çæ', '„ÉÄ', '„ÉÇ', '„ÉÖ', '„Éá', '„Éâ', '„Éê', '„Éì', '„Éñ', '„Éô', '„Éú'];
            const handakuten = ['„Å±', '„Å¥', '„Å∑', '„Å∫', '„ÅΩ', '„Éë', '„Éî', '„Éó', '„Éö', '„Éù'];
            const small = ['„ÅÅ', '„ÅÉ', '„ÅÖ', '„Åá', '„Åâ', '„Å£', '„ÇÉ', '„ÇÖ', '„Çá', '„Ç°', '„Ç£', '„Ç•', '„Çß', '„Ç©', '„ÉÉ', '„É£', '„É•', '„Éß'];
            
            if (dakuten.includes(char)) return 'dakuten';
            if (handakuten.includes(char)) return 'handakuten';
            if (small.includes(char)) return 'small';
            return '';
        }

        function switchMode(mode) {
            currentMode = mode;
            document.getElementById('hiragana-keyboard').classList.add('hidden');
            document.getElementById('katakana-keyboard').classList.add('hidden');
            document.getElementById(mode + '-keyboard').classList.remove('hidden');
            document.querySelectorAll('.mode-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
        }

        function showPopup(groupKey) {
            const group = characterGroups[groupKey];
            if (!group) return;
            
            const overlay = document.getElementById('popupOverlay');
            const title = document.getElementById('popupTitle');
            const grid = document.getElementById('popupGrid');
            
            title.textContent = group.title;
            grid.innerHTML = '';
            
            group.chars.forEach(char => {
                const key = document.createElement('div');
                key.className = 'popup-key ' + getCharClass(char);
                key.textContent = char;
                key.onclick = () => {
                    insertText(char);
                    closePopup();
                };
                grid.appendChild(key);
            });
            
            overlay.classList.add('active');
        }

        function closePopup() {
            document.getElementById('popupOverlay').classList.remove('active');
        }

        function insertText(text) {
            const textarea = document.getElementById('textInput');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            const before = textarea.value.substring(0, start);
            const after = textarea.value.substring(end);
            
            textarea.value = before + text + after;
            textarea.selectionStart = textarea.selectionEnd = start + text.length;
            textarea.focus();
        }

        function backspace() {
            const textarea = document.getElementById('textInput');
            const start = textarea.selectionStart;
            const end = textarea.selectionEnd;
            
            if (start > 0 || end > start) {
                const before = textarea.value.substring(0, start - (start === end ? 1 : 0));
                const after = textarea.value.substring(end);
                textarea.value = before + after;
                textarea.selectionStart = textarea.selectionEnd = before.length;
            }
            textarea.focus();
        }

        function copyText() {
            const textarea = document.getElementById('textInput');
            textarea.select();
            navigator.clipboard.writeText(textarea.value).then(function() {
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ Î≥µÏÇ¨Îê®!';
                btn.style.background = '#4caf50';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 2000);
            }).catch(function() {
                document.execCommand('copy');
                const btn = event.target;
                const originalText = btn.textContent;
                btn.textContent = '‚úÖ Î≥µÏÇ¨Îê®!';
                btn.style.background = '#4caf50';
                
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 2000);
            });
        }

        function clearText() {
            document.getElementById('textInput').value = '';
            document.getElementById('textInput').focus();
        }

        // ESCÌÇ§Î°ú ÌåùÏóÖ Îã´Í∏∞
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closePopup();
            }
        });

        window.onload = function() {
            document.getElementById('textInput').focus();
        };
    </script>
</body>
</html>